; Supervisor configuration for Symfony Messenger workers
; Copy this file to /etc/supervisor/conf.d/messenger-worker.conf

[program:qbilhub-messenger-async]
command=php /var/www/qbilhub/bin/console messenger:consume async --time-limit=3600 --memory-limit=128M
user=www-data
numprocs=2
startsecs=0
autostart=true
autorestart=true
startretries=10
process_name=%(program_name)s_%(process_num)02d
stderr_logfile=/var/log/qbilhub/messenger-async.err.log
stdout_logfile=/var/log/qbilhub/messenger-async.out.log

[program:qbilhub-messenger-priority]
command=php /var/www/qbilhub/bin/console messenger:consume async_priority --time-limit=3600 --memory-limit=128M
user=www-data
numprocs=1
startsecs=0
autostart=true
autorestart=true
startretries=10
process_name=%(program_name)s_%(process_num)02d
stderr_logfile=/var/log/qbilhub/messenger-priority.err.log
stdout_logfile=/var/log/qbilhub/messenger-priority.out.log

[group:qbilhub-messenger]
programs=qbilhub-messenger-async,qbilhub-messenger-priority
priority=999
